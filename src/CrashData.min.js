function CreateDelete(e){let t=document.getElementById(e),a=t.querySelector("tbody"),l=t.querySelector("thead"),o=t.querySelector("tfoot"),n=a.querySelectorAll("tr"),r=l.querySelector("tr"),i=o.querySelector("tr"),s=document.createElement("th"),d=document.createElement("th");s.textContent="Action",d.textContent="Action",r.appendChild(s),i.appendChild(d),n.forEach((e,t)=>{let a=document.createElement("td");a.innerHTML='<img class="icon-delete" style="width:30px;" id="hapus'+t+'" src="https://cdn-icons-png.flaticon.com/128/10336/10336279.png" />',e.appendChild(a)})}function ResizeTable(e){$("#"+e+" th").css("cursor","col-resize");var t,a,l=!1,o=void 0;$("#"+e+" th").mousedown(function(e){o=$(this),l=!0,t=e.pageX,a=$(this).width(),$(o).addClass("resizing"),console.log(o)}),$(document).mousemove(function(e){l&&$(o).width(a+(e.pageX-t))}),$(document).mouseup(function(){l&&($(o).removeClass("resizing"),l=!1)})}function Modal(e,t,a="Close",l="",o=()=>{}){var n=_buildModal(e,t,a,l,o);document.body.append(n),this.bsModal=bootstrap.Modal.getOrCreateInstance(n),this.show=function(){this.bsModal.show()}}function DeleteModal(){$(".modal").remove(),$(".modal-custom").remove(),$(".modal-backdrop").remove(),$(".modal-dialog").remove(),$("body").removeClass("modal-open"),$("body").removeAttr("style")}function _buildModal(e,t,a,l,o){var n=document.createElement("div");n.setAttribute("class","modal fade modal-custom"),n.setAttribute("tabindex","-1"),n.setAttribute("aria-labelledby","modalLabel"),n.setAttribute("aria-hidden","true");var r=document.createElement("div");r.setAttribute("class","modal-dialog");var i=document.createElement("div");i.setAttribute("class","modal-content");var s=_buildModalHeader(e);i.append(s);var d=document.createElement("div");d.setAttribute("class","modal-body"),d.innerHTML=t,i.append(d);var c=_buildModalFooter(a,l,o);return i.append(c),r.append(i),n.append(r),n}function _buildModalHeader(e){var t=document.createElement("div");t.setAttribute("class","modal-header"),t.setAttribute("style","border-bottom: none;");var a=document.createElement("h5");a.setAttribute("class","modal-title"),a.setAttribute("id","modalLabel"),a.innerText=e;var l=document.createElement("button");return l.setAttribute("class","btn-close"),l.setAttribute("data-bs-dismiss","modal"),l.setAttribute("aria-label","Close"),t.append(a),t.append(l),t}function _buildModalFooter(e,t,a){var l=document.createElement("div");l.setAttribute("class","modal-footer"),l.setAttribute("style","border-top: none;");var o=document.createElement("button");if(o.setAttribute("type","button"),o.setAttribute("class","btn btn-secondary"),o.setAttribute("data-bs-dismiss","modal"),o.innerText=e,l.append(o),t&&a){var n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("class","btn btn-primary"),n.innerText=t,n.addEventListener("click",a),l.append(n)}return l}function ShowDetailTable(e){table=e.table,idTable=e.id,headerModal=e.header_detail,customDetail=e.custom_value,valueDetail=e.value_html,$("#"+idTable+" tbody").on("contextmenu","tr",function(e){if(e.preventDefault(),$(this).hasClass("selected"))$(this).removeClass("selected");else{table.$("tr.selected").removeClass("selected"),$(this).addClass("selected");var t=table.rows(".selected").data(),a="";if(t.length>=1)for(var l=0;l<t.length;l++)a=a+"<h3>"+t[l][1]+"</h3><h3>"+t[l][2]+"</h3>";else alert("Please select member data.");customDetail?new Modal(headerModal,valueDetail,"Close","Confirm",()=>!1).show():new Modal(headerModal,a,"Close","Confirm",()=>!1).show()}})}function EditTable(e){var t=e.id,a=e.table,l=e.row_id,o=e.convert_html,n=e.rageEx,r=e.url,i=e.url_load,s=e.id_div_callback;$("#"+t+" tbody").on("dblclick","td",function(){var t=$(this).attr("alias"),d=a.cell(this),c=d["0"][0].column,u=d["0"][0].row,m=d.context[0].aoData[u]._aData[l];d.context[0].aoColumns[c].sTitle;var b=d.data();if(o)var f=m.replace(n,"");else var f=m;console.log(f),console.log(t);var p=b.toString();if(document.getElementById(e.id_body_table).getElementsByTagName("input").length>0)return Swal.fire({title:"Silahkan Selesaikan Edit Table Terlebih Dahulu",text:"",type:"error"}).then(function(e){$("input").focus()}),!1;if(-1===p.search("<input")){d.data('<input type="text" class="form-control-sm" id="input'+m+'" value="'+b+'"/>');var h=document.getElementById(`input${m}`);h.addEventListener("keyup",function(e){if("Enter"===e.key){e.preventDefault();var a={};a.value=h.value,a.parameters=t,a.code=f,updateField__(f,m,r,a,t,e=>{e?Swal.fire({title:e,text:"",type:"error"}).then(function(e){return!1}):Swal.fire({title:"Berhasil Update",text:"",type:"error"}).then(function(e){LoadData(i,s)})})}})}})}$.fn.CrashDataTable=function(e,t,a){let l={};var o={},n={},r={},i={},s={},d={},c={},u={},m={},b=e.TotalFormadd,f=e.ConfigForm,p=e.StartFixedCloumn,h=e.ConfigButton,v=e.GroupRowSpan;console.log(f),e.ButtonHeader&&(h.Excel&&(d={text:"Export Excel",className:"btn btn-outline-success",action:function(){ExportExcelTable(e.id,"Export Excel.xlsx")}}),h.Copy&&(m={text:"Copy Data",className:"btn btn-outline-info",action:function(){var t=document.getElementById(e.id),a=document.createRange();a.selectNode(t),window.getSelection().addRange(a),document.execCommand("copy"),Swal.fire({title:"Copy Data",text:"Silahkan Paste Data",icon:"success"})}}),h.Pdf&&(c={text:"Export PDF",className:"btn btn-outline-danger",action:function(){var t=new jsPDF;t.autoTable({html:$("#"+e.id).get(0),headStyles:{halign:"center",valign:"middle"},bodyStyles:{halign:"center"},margin:{top:30}}),t.save("Export PDF.pdf")}}),h.AddData&&(u={text:"Add Data",className:"btn btn-outline-primary",action:function(e,t,a,o){console.log(e);var n="";for(let r=0;r<b;r++)n=n+'<div class="col-lg-12"><input class="form-control" placeholder="'+(placeholder=f.Placehorder[r])+'" id="'+(idForm=f.id[r])+r+'"></div><br> ';new Modal("Add Data",n,"Close","Confirm",()=>{let e=f.UrlLinkEnd,t=f.urlLoad,a=f.idDivCall;for(let o=0;o<b;o++){let n=f.id[o];f.Placehorder[o];let r=document.getElementById(n+o).value;l[n]=r}$.ajax({type:"POST",url:e,data:l}).success(function(e){Swal.fire({title:"Berhasil!",text:"Anda Berhasil Input Data",icon:"success"});for(let o=0;o<b;o++){let n=f.id[o];f.Placehorder[o];let r=document.getElementById(n+o).value="";l[n]=r}DeleteModal(),LoadData(t,a)})}).show()}}),s={dom:"Bfrtip",buttons:{dom:{button:{className:"btn"}},buttons:[d,c,m,u]}}),e.ResizeTable&&ResizeTable(e.id),e.ShortTable&&(n={iDisplayLength:-1,aaSorting:[[e.ShortingRow,e.TypeShorting]]}),e.RowGroup&&(r={columnDefs:[{visible:!1,targets:e.GroupsColumn}],order:[[e.GroupsColumn,"asc"]],drawCallback:function(t){var a=this.api(),l=a.rows({page:"current"}).nodes(),o=null;a.column(e.GroupsColumn,{page:"current"}).data().each(function(e,t){o!==e&&($(l).eq(t).before('<tr class="group bg-secondary text-white" data-f-color="f9f9f9" data-fill-color="000000" ><td style="font-size: 15px;" colspan="'+v+'">'+e+"</td></tr>"),o=e)})}}),e.FixedCloumn&&(i={fixedColumns:{start:p}}),e.button?o={dom:"Bfrtip",buttons:{dom:{button:{className:"btn"}},buttons:[{text:"Export Excel",className:"btn btn-outline-success",action:function(){ExportExcelTable(e.id,"Export Excel.xlsx")}},{text:"Export PDF",className:"btn btn-outline-danger",action:function(){var t=new jsPDF;t.autoTable({html:"#"+e.id}),t.save("CrashDataTable.pdf")}},{text:"Add Data",className:"btn btn-outline-primary",action:function(e,t,a,o){console.log(e);var n="";for(let r=0;r<b;r++)n=n+'<div class="col-lg-12"><input class="form-control" placeholder="'+(placeholder=f.Placehorder[r])+'" id="'+(idForm=f.id[r])+r+'"></div><br> ';new Modal("Add Data",n,"Close","Confirm",()=>{let e=f.UrlLinkEnd,t=f.urlLoad,a=f.idDivCall;for(let o=0;o<b;o++){let n=f.id[o];f.Placehorder[o];let r=document.getElementById(n+o).value;l[n]=r}$.ajax({type:"POST",url:e,data:l}).success(function(e){Swal.fire({title:"Berhasil!",text:"Anda Berhasil Input Data",icon:"success"});for(let o=0;o<b;o++){let n=f.id[o];f.Placehorder[o];let r=document.getElementById(n+o).value="";l[n]=r}DeleteModal(),LoadData(t,a)})}).show()}}]},initComplete:function(){this.api().columns().every(function(){let e=this,t=e.footer().textContent,a=document.createElement("input");a.classList.add("form-footer"),a.style.width="auto",a.placeholder=t,e.footer().replaceChildren(a),a.addEventListener("keyup",()=>{e.search()!==this.value&&e.search(a.value).draw()})})}}:e.Excel?o={dom:"Bfrtip",buttons:{dom:{button:{className:"btn"}},buttons:[{text:"Export Excel",className:"btn btn-outline-success",action:function(){ExportExcelTable(e.id,"Export Excel.xlsx")}}]}}:e.Pdf?o={dom:"Bfrtip",buttons:{dom:{button:{className:"btn"}},buttons:[{text:"Export PDF",className:"btn btn-outline-danger",action:function(){var t=new jsPDF;t.autoTable({html:"#"+e.id}),t.save("CrashDataTable.pdf")}}]}}:e.SearchFooter?o={initComplete:function(){this.api().columns().every(function(){let e=this,t=e.footer().textContent,a=document.createElement("input");a.classList.add("form-footer"),a.style.width="auto",a.placeholder=t,e.footer().replaceChildren(a),a.addEventListener("keyup",()=>{e.search()!==this.value&&e.search(a.value).draw()})})}}:e.ButtonAddData&&(o={dom:"Bfrtip",buttons:{dom:{button:{className:"btn"}},buttons:[{text:"Add Data",className:"btn btn-outline-primary",action:function(e,t,a,o){var n="";for(let r=0;r<b;r++)n=n+'<div class="col-lg-12"><input class="form-control" placeholder="'+(placeholder=f.Placehorder[r])+'" id="'+(idForm=f.id[r])+r+'"></div><br> ';new Modal("Add Data",n,"Close","Confirm",()=>{let e=f.UrlEndPoint,t=f.urlLoad,a=f.idDivCall;for(let o=0;o<b;o++){let n=f.id[o];f.Placehorder[o];let r=document.getElementById(n+o).value;l[n]=r}$.ajax({type:"POST",url:e,data:l}).success(function(e){Swal.fire({title:"Berhasil!",text:"Anda Berhasil Input Data",icon:"success"}),DeleteModal(),LoadData(t,a)})}).show()}}]}});let x={...o,...t,...n,...i,...r,...s};return this.DataTable(x)};const updateField__=(e,t,a,l,o,n)=>{console.log(l),""==o&&Swal.fire({title:err,text:"",type:"Tidak Dapat Mengedit Data !"}).then(function(e){return!1}),$.ajax({type:"POST",url:a,data:l}).success(function(e){n(null)}).error(function(e){n(e)})};function LoadData(e,t){$.LoadingOverlay("show"),$("#"+t).empty(),$("#"+t).load(e,function(e,t,a){"error"==t?($.LoadingOverlay("hide"),Swal.fire({title:"Sorry but there was an error: "+a.status+" "+a.statusText,text:"",type:"error"}).then(function(e){return!1})):$.LoadingOverlay("hide")})}function DeleteData(e){console.log(e);var t=e.id,a=e.WhereId;e.table;var l=e.UrlEndPoint,o=e.EndPointNameDB,n=e.urlLoad,r=e.DivCallback;CreateDelete(t),$("#"+e.id+" tbody").on("click","tr img.icon-delete",function(){let t=this.closest("tr"),i=t.cells[a].textContent;console.log(i),Swal.fire({title:"Are you sure?",text:"Anda Akan Menghapus Data Ini !",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(t=>{t.isConfirmed&&(data={database:o,id:i},$.ajax({type:"POST",url:l,data:data}).success(function(t){e.table.row($(this).parents("tr")).remove().draw(),Swal.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success"}),LoadData(n,r)}).error(function(e){Swal.fire({title:"Deleted!",text:"Your file has been Not deleted.",icon:"error"})}))})})}function ExportExcelTable(e,t){let a=document.getElementById(e),l=a.getElementsByTagName("tr");for(let o=0;o<l.length;o++){let n=l[o].getElementsByTagName("td");if(o%2!=0)for(let r=0;r<n.length;r++)n[r].setAttribute("data-fill-color","e2fbff");else for(let i=0;i<n.length;i++)n[i].setAttribute("data-fill-color","f2f2f2")}TableToExcel.convert(document.getElementById(e),{name:t,sheet:{name:"Sheet 1"}})}